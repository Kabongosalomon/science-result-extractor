section: title
Improved Part-of-Speech Tagging for Online Conversational Text with Word Clusters
section: abstract
We consider the problem of part-of-speech tagging for informal, online conversational text. We systematically evaluate the use of large-scale unsupervised word clustering and new lexical features to improve tagging accuracy. With these features, our system achieves state-of-the-art tagging results on both Twitter and IRC POS tagging tasks; Twitter tagging is improved from 90% to 93% accuracy (more than 3% absolute). Qualitative analysis of these word clusters yields insights about NLP and linguistic phenomena in this genre. Additionally, we contribute the first POS annotation guidelines for such text and release anew dataset of English language tweets annotated using these guidelines. Tagging software, annotation guidelines, and large-scale word clusters are available at:
section: Introduction
Online conversational text, typified by microblogs, chat, and text messages, 1 is a challenge for natural language processing. Unlike the highly edited genres that conventional NLP tools have been developed for, conversational text contains many nonstandard lexical items and syntactic patterns. These are the result of unintentional errors, dialectal variation, conversational ellipsis, topic diversity, and creative use of language and orthography. An example is shown in. As a result of this widespread variation, standard model-1 Also referred to as computer-mediated communication. ing assumptions that depend on lexical, syntactic, and orthographic regularity are inappropriate. There is preliminary work on social media part-of-speech (POS) tagging), named entity recognition (), and parsing), but accuracy rates are still significantly lower than traditional well-edited genres like newswire. Even web text parsing, which is a comparatively easier genre than social media, lags behind newspaper text, as does speech transcript parsing.
To tackle the challenge of novel words and constructions, we create anew Twitter part-of-speech tagger-building on previous work by-that includes new large-scale distributional features. This leads to state-of-the-art results in POS tagging for both Twitter and Internet Relay Chat (IRC) text. We also annotated anew dataset of tweets with POS tags, improved the annotations in the previous dataset from Gimpel et al., and developed annotation guidelines for manual POS tagging of tweets. We release all of these resources to the research community:
• an open-source part-of-speech tagger for online conversational text ( §2); • unsupervised Twitter word clusters ( §3);
• an improved emoticon detector for conversational text ( §4); • POS annotation guidelines ( §5.1); and • anew dataset of 547 manually POS-annotated tweets ( §5).
section: MEMM Tagger
Our tagging model is a first-order maximum entropy Markov model (MEMM), a discriminative sequence model for which training and decoding are extremely efficient). The probability of a tag y t is conditioned on the input sequence x and the tag to its lefty t−1 , and is parameterized by a multiclass logistic regression:
We use transition features for every pair of labels, and extract base observation features from token t and neighboring tokens, and conjoin them against all K = 25 possible outputs in our coarse tagset (Appendix A). Our feature sets will be discussed below in detail.
Decoding. For experiments reported in this paper, we use the O(|x|K 2 ) Viterbi algorithm for prediction; K is the number of tags. This exactly maximizes p(y | x), but the MEMM also naturally allows a faster O(|x|K) left-to-right greedy decoding:
which we find is 3 times faster and yields similar accuracy as Viterbi (an insignificant accuracy decrease of less than 0.1% absolute on the DAILY547 test set discussed below). Speed is paramount for social media analysis applications-which often require the Although when compared to CRFs, MEMMs theoretically suffer from the "label bias" problem (), our system substantially outperforms the CRF-based taggers of previous work; and when comparing to Gimpel et al. system with similar feature sets, we observed little difference inaccuracy. This is consistent with conventional wisdom that the quality of lexical features is much more important than the parametric form of the sequence model, at least in our setting: part-ofspeech tagging with a small labeled training set. processing of millions to billions of messages-so we make greedy decoding the default in the released software.
This greedy tagger runs at 800 tweets/sec. (10,000 tokens/sec.) on a single CPU core, about 40 times faster than Gimpel et al.'s system. The tokenizer by itself ( §4) runs at 3,500 tweets/sec. 3
Training and regularization. During training, the MEMM log-likelihood fora tagged tweet x, y is the sum over the observed token tags y t , each conditional on the tweet being tagged and the observed previous tag (with a start symbol before the first token in x), (x, y, β) = |x| t=1 log p(y t | y t−1 , x, t; β). We optimize the parameters β with OWL-QN, an L 1 -capable variant of L-BFGS ( to minimize the regularized objective
where N is the number of tokens in the corpus and the sum ranges overall tagged tweets x, yin the training data. We use elastic net regularization (), which is a linear combination of L 1 and L 2 penalties; here j indexes overall features:
Using even a very small L 1 penalty eliminates many irrelevant or noisy features.
section: Unsupervised Word Clusters
Our POS tagger can make use of any number of possibly overlapping features. While we have only a small amount of hand-labeled data for training, we also have access to billions of tokens of unlabeled conversational text from the web. Previous work has shown that unlabeled text can be used to induce unsupervised word clusters which can improve the performance of many supervised NLP tasks (, inter alia). We use a similar approach hereto improve tagging performance for online conversational text.
We also make our induced clusters publicly available in the hope that they will be useful for other NLP tasks in this genre.
section: Clustering Method
We obtained hierarchical word clusters via Brown clustering () on a large set of unlabeled tweets. The algorithm partitions words into abase set of 1,000 clusters, and induces a hierarchy among those 1,000 clusters with a series of greedy agglomerative merges that heuristically optimize the likelihood of a hidden Markov model with a one-class-per-lexical-type constraint. Not only does Brown clustering produce effective features for discriminative models, but its variants are better unsupervised POS taggers than some models developed nearly 20 years later; see comparisons in Blunsom and Cohn (2011). The algorithm is attractive for our purposes since it scales to large amounts of data. When training on tweets drawn from a single day, we observed time-specific biases (e.g., numerical dates appearing in the same cluster as the word tonight), so we assembled our unlabeled data from a random sample of 100,000 tweets per day from September 10, 2008 to August 14, 2012, and filtered out non-English tweets (about 60% of the sample) using langid.py. Each tweet was processed with our to-kenizer and lowercased. We normalized all atmentions to @MENTION and URLs/email addresses to their domains (e.g. http://bit.ly/ dP8rR8 ⇒ URL-bit.ly). In an effort to reduce spam, we removed duplicated tweet texts (this also removes retweets) before word clustering. This normalization and cleaning resulted in 56 million unique tweets (847 million tokens). We set the clustering software's count threshold to only cluster words appearing 40 or more times, yielding 216,856 word types, which took 42 hours to cluster on a single CPU. shows example clusters. Some of the challenging words in the example tweet ( are highlighted. The term lololol (an extension of lol for "laughing out loud") is grouped with a large number of laughter acronyms (A1: "laughing my (fucking) ass off," "cracking the fuck up"). Since expressions of laughter are so prevalent on Twitter, the algorithm creates another laughter cluster (A1's sibling A2), that tends to have onomatopoeic, non-acronym variants (e.g., haha). The acronym ikr ("I know, right?") is grouped with expressive variations of "yes" and "no" (A4). Note that A1-A4 are grouped in a fairly specific subtree; and indeed, in this message ikr and lololol are both tagged as interjections.
section: Cluster Examples
smh ("shaking my head," indicating disapproval) seems related, though is always tagged in the annotated data as a miscellaneous abbreviation (G); the difference between acronyms that are interjections versus other acronyms maybe complicated. Here, smh is in a related but distinct subtree from the above expressions (A5); its usage in this example is slightly different from its more common usage, which it shares with the other words in its cluster: message-ending expressions of commentary or emotional reaction, sometimes as a metacomment on the author's message; e.g., Maybe you could get a guy to date you if you actually respected yourself #smh or There is really NO reason why other girls should send my boyfriend a goodmorning text #justsaying.
We observe many variants of categories traditionally considered closed-class, including pronouns (B: u = "you") and prepositions (C: fir = "for").
There is also evidence of grammatical categories specific to conversational genres of English; clusters E1-E2 demonstrate variations of single-word contractions for "going to" and "trying to," some of which have more complicated semantics. Finally, the HMM learns about orthographic variants, even though it treats all words as opaque symbols; cluster F consists almost entirely of variants of "so," their frequencies monotonically decreasing in the number of vowel repetitions-a phenomenon called "expressive lengthening" or "affective lengthening" (). This suggests a future direction to jointly model class sequence and orthographic information).
We have built an HTML viewer to browse these and numerous other interesting examples.
section: Emoticons and Emoji
We use the term emoticon to mean a face or icon constructed with traditional alphabetic or punctua-tion symbols, and emoji to mean symbols rendered in software as small pictures, inline with the text.
Since our tokenizer is careful to preserve emoticons and other symbols (see §4), they are clustered just like other words. Similar emoticons are clustered together (G1-G4), including separate clusters of happy
emoticons. The clusters are not perfectly aligned with our POS annotation guidelines; for example, the "sad" emoticon cluster included emotion-bearing terms that our guidelines define as non-emoticons, such as #ugh, #tear, and #fml ("fuck my life"), though these seem potentially useful for sentiment analysis.
One difficult task is classifying different types of symbols in tweets: our annotation guidelines differentiate between emoticons, punctuation, and garbage (apparently non-meaningful symbols or tokenization errors). Several Unicode character ranges are reserved for emoji-style symbols (including the three Unicode hearts in G4); however, depending on the user's software, characters in these ranges might be rendered differently or not at all. We have found instances where the clustering algorithm groups proprietary iOS emoji symbols along with normal emoticons; for example, the character U+E056, which is interpreted on iOS as a smiling face, is in the same G2 cluster as smiley face emoticons. The symbol U+E12F, which represents a picture of a bag of money, is grouped with the words cash and money.
section: Cluster-Based Features
Since Brown clusters are hierarchical in a binary tree, each word is associated with a tree path represented as a bitstring with length ≤ 16; we use prefixes of the bitstring as features (for all prefix lengths ∈ {2, 4, 6, . . . , 16}). This allows sharing of statistical strength between similar clusters. Using prefix features of hierarchical clusters in this way was similarly found to be effective for named-entity recognition ( and Twitter POS tagging (.
When checking to see if a word is associated with a cluster, the tagger first normalizes the word using the same techniques as described in §3.1, then creates a priority list of fuzzy match transformations of the word by removing repeated punctuation and repeated characters. If the normalized word is not in a cluster, the tagger considers the fuzzy matches. Although only about 3% of the tokens in the development set ( §6) did not appear in a clustering, this method resulted in a relative error decrease of 18% among such word tokens.
section: Other Lexical Features
Besides unsupervised word clusters, there are two other sets of features that contain generalized lexical class information. We use the tag dictionary feature from Gimpel et al., which adds a feature fora word's most frequent part-of-speech tag. 8 This can be viewed as a feature-based domain adaptation method, since it gives lexical type-level information for standard English words, which the model learns to map between PTB tags to the desired output tags. Second, since the lack of consistent capitalization conventions on Twitter makes it especially difficult to recognize names- found relatively low accuracy on proper nouns-we added a token-level name list feature, which fires on (non-function) words from names from several sources: Freebase lists of celebrities and video games, the Moby Words list of US Locations, and lists of male, female, family, and proper names from Mark Kantrowitz's name corpus.
section: Tokenization and Emoticon Detection
Word segmentation on Twitter is challenging due to the lack of orthographic conventions; in particular, punctuation, emoticons, URLs, and other symbols may have no whitespace separation from textual Frequencies came from the Wall Street Journal and Brown corpus sections of the Penn Treebank. If a word has multiple PTB tags, each tag is a feature with value for the frequency rank; e.g. for three different tags in the PTB, this feature gives a value of 1 for the most frequent tag, 2/3 for the second, etc. Coarse versions of the PTB tags are used). While 88% of words in the dictionary have only one tag, using rank information seemed to give a small but consistent gain over only using the most common tag, or using binary features conjoined with rank as in  words (e.g. no:-d,yes should parse as four tokens), and internally may contain alphanumeric symbols that could be mistaken for words: a naive split(/[^a-zA-Z0-9]+/) tokenizer thinks the words "p" and "d" are among the top 100 most common words on Twitter, due to misanalysis of :p and :d. Traditional Penn Treebank-style tokenizers are hardly better, often breaking a string of punctuation characters into a single token per character.
We rewrote twokenize (O'), a rule-based tokenizer, emoticon, and URL detector, for use in the tagger. Emoticons are especially challenging, since they are open-class and productive. We revise O'Connor et al.'s regular expression grammar that describes possible emoticons, adding a grammar of horizontal emoticons (e.g. -_-), known as "Eastern-style," 11 though we observe high usage in English-speaking Twitter). We also add a number of other improvements to the patterns. Because this system was used as preprocessing for the word clustering experiment in §3, we were able to infer the emoticon clusters in. Furthermore, whether a token matches the emoticon pattern is also used as a feature in the tagger ( §2).
URL recognition is also difficult, since the http:// is often dropped, resulting in protocol-less URLs like about.me. We add recognition patterns for these by using a list of top-level and country domains.
section: Annotated Dataset
Gimpel et al. (2011) provided a dataset of POStagged tweets consisting almost entirely of tweets sampled from one particular day (. We were concerned about overfitting to timespecific phenomena; for example, a substantial fraction of the messages are about a basketball game happening that day.
We created anew test set of 547 tweets for evaluation. The test set consists of one random English tweet from everyday between January 1, 2011 and June 30, 2012. In order fora tweet to be considered English, it had to contain at least one English word other than a URL, emoticon, or at-mention. We noticed biases in the outputs of langid.py, so we instead selected these messages completely manu-ally (going through a random sample of one day's messages until an English message was found).
section: Annotation Methodology
Gimpel et al. provided a tagset for Twitter (shown in Appendix A), which we used unmodified. The original annotation guidelines were not published, but in this work we recorded the rules governing tagging decisions and made further revisions while annotating the new data. 12 Some of our guidelines reiterate or modify rules made by Penn Treebank annotators, while others treat specific phenomena found on Twitter (refer to the next section).
Our tweets were annotated by two annotators who attempted to match the choices made in Gimpel et al.'s dataset. The annotators also consulted the POS annotations in the Penn Treebank ( as an additional reference. Differences were reconciled by a third annotator in discussion with all annotators. 13 During this process, an inconsistency was found in Gimpel et al.'s data, which we corrected (concerning the tagging of this/that, a change to 100 labels, 0.4%). The new version of Gimpel et al.'s data (called OCT27), as well as the newer messages (called DAILY547), are both included in our data release.
section: Compounds in Penn Treebank vs. Twitter
Ritter et al. (2011) annotated tweets using an augmented version of the PTB tagset and presumably followed the PTB annotation guidelines. We wrote new guidelines because the PTB conventions are inappropriate for Twitter in several ways, as shown in the design of Gimpel et al.'s tagset. Importantly, "compound" tags (e.g., nominal+verbal and nominal+possessive) are used because tokenization is difficult or seemingly impossible for the nonstandard word forms that are commonplace in conversational text.
For example, the PTB tokenization splits contractions containing apostrophes: I'm ⇒ I/PRP 'm/VBP. But conversational text often contains variants that resist a single PTB tag (like im), or even challenge traditional English grammatical categories (like imma or umma, which both mean "I am going to"). One strategy would be to analyze these forms into a PTB-style tokenization, as discussed in, who proposes to analyze doncha as do/VBP ncha/PRP, but notes it would be difficult. We think this is impossible to handle in the rulebased framework used by English tokenizers, given the huge (and possibly growing) number of large compounds like imma, gonna, w/that, etc. These are not rare: the word clustering algorithm discovers hundreds of such words as statistically coherent classes (e.g. clusters E1 and E2 in; and the word imma is the 962nd most common word in our unlabeled corpus, more frequent than cat or near.
We do not attempt to do Twitter "normalization" into traditional written English (), which we view as a lossy translation task. In fact, many of Twitter's unique linguistic phenomena are due not only to its informal nature, but also a set of authors that heavily skews towards younger ages and minorities, with heavy usage of dialects that are different than the standard American English most often seen in NLP datasets). For example, we suspect that imma may implicate tense and aspect markers from African-American Vernacular English. Trying to impose PTB-style tokenization on Twitter is linguistically inappropriate: should the lexico-syntactic behavior of casual conversational chatter by young minorities be straightjacketed into the stylistic conventions of the 1980s Wall Street Journal? Instead, we would like to directly analyze the syntax of online conversational text on its own terms.
Thus, we choose to leave these word forms untokenized and use compound tags, viewing compositional multiword analysis as challenging future work. We believe that our strategy is sufficient for many applications, such as chunking or named entity recognition; many applications such as sentiment analysis3), open information extraction, and information retrieval  patterns that seem quite compatible with our approach. More complex downstream processing like parsing is an interesting challenge, since contraction parsing on traditional text is probably a benefit to current parsers. We believe that any PTB-trained tool requires substantial retraining and adaptation for Twitter due to the huge genre and stylistic differences (Foster et al., 2011); thus tokenization conventions area relatively minor concern. Our simple-toannotate conventions make it easier to produce new training data.
section: Experiments
We are primarily concerned with performance on our annotated datasets described in §5 (OCT27, DAILY547), though for comparison to previous work we also test on other corpora (RITTERTW in §6.2, NPSCHAT in §6.3). The annotated datasets are listed in.
section: Main Experiments
We use OCT27 to refer to the entire dataset described in it is split into training, development, and test portions (OCT27TRAIN, OCT27DEV, OCT27TEST). We use DAILY547 as an additional test set. Neither OCT27TEST nor DAILY547 were extensively evaluated against until final ablation testing when writing this paper. The total number of features is 3.7 million, all of which are used under pure L 2 regularization; but only 60,000 are selected by elastic net regularization with (λ 1 , λ 2 ) = (0.25, 2), which achieves nearly the same (but no better) accuracy as pure L 2 , and we use it for all experiments. We observed that it was We conducted a grid search for the regularizer values on part of DAILY547, and many regularizer values give the best or nearly the best results. We suspect a different setup would have yielded similar results.    possible to get radically smaller models with only a slight degradation in performance: (4, 0.06) has 0.5% worse accuracy but uses only 1,632 features, a small enough number to browse through manually. First, we evaluate on the new test set, training on all of OCT27. Due to DAILY547's statistical representativeness, we believe this gives the best view of the tagger's accuracy on English Twitter text. The full tagger attains 93.2% accuracy (final row of Table 2).
To facilitate comparisons with previous work, we ran a series of experiments training only on OCT27's training and development sets, then report test results on both OCT27TEST and all of DAILY547, shown in. Our tagger achieves substantially higher accuracy than. Feature ablation. A number of ablation tests indicate the word clusters area very strong source of lexical knowledge. When dropping the tag dictionaries and name lists, the word clusters maintain most of the accuracy (row 2). If we drop the clusters and rely only on tag dictionaries and namelists, accuracy decreases significantly (row 3). In fact, we can remove all observation features except for word clusters-no word features, orthographic fea-   tures, affix n-grams, capitalization, emoticon patterns, etc.-and the accuracy is in fact still better than the previous work (row 4). We also wanted to know whether to keep the tag dictionary and name list features, but the splits reported in did not show statistically significant differences; so to better discriminate between ablations, we created a lopsided train/test split of all data with a much larger test portion (26,974 tokens), having greater statistical power (tighter confidence intervals of ± 0.3%). The full system got 90.8% while the no-tag dictionary, no-namelists ablation had 90.0%, a statistically significant difference. Therefore we retain these features.
Compared to the tagger in Gimpel et al., most of our feature changes are in the new lexical features described in §3.5. We do not reuse the other lexical features from the previous work, including a phonetic normalizer (Metaphone), a name list consisting of words that are frequently capitalized, and distributional features trained on a much smaller unlabeled corpus; they are all worse than our new lexical features described here. (We did include, however, a variant of the tag dictionary feature that uses phonetic normalization for lookup; it seemed to yield a small improvement.) Furthermore, when evaluating the clusters as unsupervised (hard) POS tags, we obtain a many-to-one accuracy of 89.2% on DAILY547. Before computing this, we lowercased the text to match the clusters and removed tokens tagged as URLs and at-mentions. Reported confidence intervals in this paper are 95% binomial normal approximation intervals for the proportion of correctly tagged tokens: ±1.96 p(1 − p)/n tokens 1/ √ n. 20 Details on the exact feature set are available in a technical report, also available on the website.
Non-traditional words. The word clusters are especially helpful with words that do not appear in traditional dictionaries. We constructed a dictionary by lowercasing the union of the ispell 'American', 'British', and 'English' dictionaries, plus the standard Unix words file from Webster's Second International dictionary, totalling 260,985 word types. After excluding tokens defined by the gold standard as punctuation, URLs, at-mentions, or emoticons, 21 22% of DAILY547's tokens do not appear in this dictionary. Without clusters, they are very difficult to classify (only 79.2% accuracy), but adding clusters generates a 5.7 point improvement-much larger than the effect on in-dictionary tokens (Table 3).
Varying the amount of unlabeled data. A tagger that only uses word clusters achieves an accuracy of 88.6% on the OCT27 development set. We created several clusterings with different numbers of unlabeled tweets, keeping the number of clusters constant at 800. As shown in, there was initially a logarithmic relationship between number of tweets and accuracy, but accuracy (and lexical coverage) levels out after 750,000 tweets. We use the largest clustering (56 million tweets and 1,000 clusters) as the default for the released tagger.
section: Evaluation on RITTERTW
Ritter et al. (2011) annotated a corpus of 787 tweets with a single annotator, using the PTB 90.0 ± 0.5, basic CRF tagger 85.3, trained on more data 88.3  tagset plus several Twitter-specific tags, referred to in as RITTERTW. Linguistic concerns notwithstanding ( §5.2), fora controlled comparison, we train and test our system on this data with the same 4-fold cross-validation setup they used, attaining 90.0% (±0.5%) accuracy. Ritter et al.'s CRFbased tagger had 85.3% accuracy, and their best tagger, trained on a concatenation of PTB, IRC, and Twitter, achieved 88.3%).
section: IRC: Evaluation on NPSCHAT
IRC is another medium of online conversational text, with similar emoticons, misspellings, abbreviations and acronyms as Twitter data. We evaluate our tagger on the NPS Chat Corpus, a PTB-part-of-speech annotated dataset of Internet Relay Chat (IRC) room messages from 2006.
First, we compare to a tagger in the same setup as experiments on this data in, training on 90% of the data and testing on 10%; we average results across 10-fold cross-validation. The full tagger model achieved 93.4% (±0.3%) accuracy, significantly improving over the best result they report, 90.8% accuracy with a tagger trained on a mix of several POS-annotated corpora.
We also perform the ablation experiments on this corpus, with a slightly different experimental setup: we first filter out system messages then split data
section: Release
1.0: http://faculty.nps.edu/ cmartell/NPSChat.htm Forsyth actually used 30 different 90/10 random splits; we prefer cross-validation because the same test data is never repeated, thus allowing straightforward confidence estimation of accuracy from the number of tokens (via binomial sample variance, footnote 19). In all cases, the models are trained on the same amount of data (90%). into 5,067 training and 2,868 test messages. Results show a similar pattern as the Twitter data (see final column of). Thus the Twitter word clusters are also useful for language in the medium of text chat rooms; we suspect these clusters will be applicable for deeper syntactic and semantic analysis in other online conversational text mediums, such as text messages and instant messages.
section: Conclusion
We have constructed a state-of-the-art part-ofspeech tagger for the online conversational text genres of Twitter and IRC, and have publicly released our new evaluation data, annotation guidelines, open-source tagger, and word clusters at http://www.ark.cs.cmu.edu/TweetNLP.
section: A Part-of-Speech Tagset
