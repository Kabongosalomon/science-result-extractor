section: title
Published as conference paper at ICLR 2015 EMBEDDING ENTITIES AND RELATIONS FOR LEARN- ING AND INFERENCE IN KNOWLEDGE BASES
section: abstract
We consider learning representations of entities and relations in KBs using the neural-embedding approach. We show that most existing models, including NTN (Socher et al., 2013) and TransE (Bordes et al., 2013b), can be generalized under a unified learning framework, where entities are low-dimensional vectors learned from a neural network and relations are bilinear and/or linear mapping functions. Under this framework, we compare a variety of embedding models on the link prediction task. We show that a simple bilinear formulation achieves new state-of-the-art results for the task (achieving a top-10 accuracy of 73.2% vs. 54.7% by TransE on Freebase). Furthermore, we introduce a novel approach that utilizes the learned relation embeddings to mine logical rules such as BornInCitypa, bq ^ CityInCountrypb, cq ùñ N ationalitypa, cq. We find that embeddings learned from the bilinear objective are particularly good at capturing relational semantics, and that the composition of relations is characterized by matrix multiplication. More interestingly, we demonstrate that our embedding-based rule extraction approach successfully outperforms a state-of-the-art confidence-based rule mining approach in mining Horn rules that involve compositional reasoning.
section: INTRODUCTION
Recent years have witnessed a rapid growth of knowledge bases (KBs) such as Freebase 1 , DBPedia (, and YAGO (. These KBs store facts about real-world entities (e.g. people, places, and things) in the form of RDF triples 2 (i.e. (subject, predicate, object)). Today's KBs are large in size. For instance, Freebase contains millions of entities and billions of facts (triples) involving a large variety of predicates (relation types). Such large-scale multirelational data provide an excellent potential for improving a wide range of tasks, from information retrieval, question answering to biological data mining.
Recently, much effort has been invested in relational learning methods that can scale to large knowledge bases. Tensor factorization (e.g. () and neural-embedding-based models (e.g. () are two popular kinds of approaches that learn to encode relational information using low-dimensional representations of entities and relations. These representation learning methods have shown good scalability and reasoning ability in terms of validating unseen facts given the existing KB.
In this work, we focus on the study of neural-embedding models, where the representations are learned using neural networks with energy-based objectives. Recent embedding models TransE () and NTN () have shown state-of-the-art prediction performance compared to tensor factorization methods such as RESCAL (. They are similar in model forms with slight differences on the choices of entity and relation representations. Without careful comparison, it is not clear how different design choices affect the˚Work the˚the˚Work conducted while interning at Microsoft Research. 1 http://freebase.com 2 http://www..org/TR/rdf11-concepts/
section: RELATED WORK
Multi-relational learning has been an active research area for the past couple of years. Traditional statistical learning approaches) such as Markov-logic networks) usually suffer from scalability issues. More recently, various types of representation learning methods have been proposed to embed multi-relational knowledge into lowdimensional representations of entities and relations, including tensor/matrix factorization, Bayesian clustering framework (, and neural networks. Our work focuses on the study of neural-embedding models as they have shown good scalability and strong generalizability on large-scale KBs.
Existing neural embedding models () all represent entities as low-dimensional vectors and represent relations as operators that combine the representations of two entities. They differ in different parametrization of relation operators. For instance, given two entity vectors, the model of Neural Tensor Network (NTN) represents each relation as a bilinear tensor operator followed by a linear matrix operator. The model of), on the other hand, represents each relation as a single vector that linearly interacts with the entity vectors. Likewise, variations on entity representations also exist. Most methods represent each entity as a unit vector while) represent entities as an average of word vectors and initializing word vectors with pre-trained vectors from external text corpora. There has not been work that closely examines the effectiveness of these different design choices.
Our work on embedding-based rule extraction presented in part of this paper is related to the earlier study on logical inference with learned continuous-space representations. Much existing work along this line focuses on learning logic-based representations for natural language sentences. For example, builds a neural network that recursively combines word representations based on parse tree structures and shows that such neural network can simulate the behavior of conjunction and negation. further demonstrates that recursive neural network can capture certain aspects of natural logical reasoning on examples involving quantifiers like some and all. Recently, shows that in theory most aspects of predicate logic can be simulated using tensor calculus. further implements the idea by introducing a supervised objective that trains embeddings to be consistent with given logical rules. The evaluation was conducted on toy data and uses limited logical forms. Different from these earlier studies, we propose a novel approach to utilizing embeddings learned without explicit logical constraints to directly mine logical rules from KBs. We demonstrate that the learned embeddings of relations can capture the compositional semantics of relations. Moreover, we systematically evaluate our approach and compare it favorably with a state-of-the-art rule mining approach on the rule extraction task on Freebase.
section: MULTI-RELATIONAL REPRESENTATION LEARNING
In this section, we present a general neural network framework for multi-relational representation learning. We discuss different design choices for the representations of entities and relations which will be empirically compared in Section 4.
Given a KB that is represented as a list of relation triplets pe 1 , r, e 2 q (denoting e 1 (the subject) and e 2 (the object) that are in a certain relationship r), we want to learn representations for entities and relations such that valid triplets receive high scores (or low energies). The embeddings can be learned via a neural network. The first layer projects a pair of input entities to low dimensional vectors, and the second layer combines these two vectors to a scalar for comparison via a scoring function with relation-specific parameters.
section: ENTITY REPRESENTATIONS
Each input entity corresponds to a high-dimensional vector, either a "one-hot" index vector or a "n-hot" feature vector. Denote by x e1 and x e2 the input vectors for entity e 1 and e 2 , respectively. Denote by W the first layer projection matrix. The learned entity representations, y e1 and y e2 can be written as
˘ where f can be a linear or non-linear function, and Wis a parameter matrix, which can be randomly initialized or initialized using pre-trained vectors.
Most existing embedding models adopt the "one-hot" input vectors except for NTN) which represents each entity as an average of its word vectors. This can be viewed as adopting "bag-of-words" vectors as input and learning a projection matrix consisting of word vectors.
section: RELATION REPRESENTATIONS
The choice of relation representations reflects in the form of the scoring function. Most of the existing scoring functions in the literature can be unified based on a basic linear transformation g a r , a bilinear transformation g b r or their combination, where g a rand g b rare defined as
which Ar and Br are relation-specific parameters.
tanh` tanh`g a r pye 1 , ye 2 q ` g b r pye 1 , ye 2 q ˘: Comparisons among several multi-relational models in their scoring functions.
In, we summarize several popular scoring functions in the literature fora relation triplet pe 1 , r, e 2 q, reformulated in terms of the above two functions. Denote by y e1 , y e2 PR n two entity vectors. Denote by Q r1 , Q r2 PR nˆm and V r PR n matrix or vector parameters for linear transformation g a r . Denote by T r PR nˆnˆm tensor parameters for bilinear transformation g b r . IP Rn is an identity matrix. u r PR m is an additional parameter for relation r. The scoring function for TransE (L2 formulation) is derived from ||y e1´ye1´e1´y e2`Ve2`e2`V r || 2 2 " 2V T r py e1´ye1´e1´y e2 q ´ 2y T e1 y e2`||Ve2`e2`||V r || 2 2 ` ||y e1 || 2 2 ` ||y e2 || 2 2 , where y e1 and y e2 are unit vectors. Note that NTN is the most expressive model as it contains both linear and bilinear relation operators as special cases. In terms of the number of parameters, TransE is the simplest model which only parametrizes the linear relation operators with one-dimensional vectors.
In this paper, we also consider the basic bilinear scoring function:
which is a special case of NTN without the non-linear layer and the linear operator, and uses a 2-d matrix operator Mr PR nˆn instead of a tensor operator. Such bilinear formulation has been used in other matrix factorization models such as in) with different forms of regularization. Here, we consider a simple way to reduce the number of relation parameters by restricting Mr to be a diagonal matrix. This results in the same number of relation parameters as TransE. Our experiments in Section 4 demonstrate that this simple formulation enjoys the same scalable property as TransE and it achieves superior performance over TransE and other more expressive models on the task of link prediction.
This general framework for relationship modeling also applies to the recent deep-structured semantic model (), which learns the relevance or a single relation between a pair of word sequences. The framework above applies when using multiple neural network layers to project entities and using a relation-independent scoring function Gr ` y e1 , y e2 ˘ " cosry e1 pW r q, y e2 pW r qs. The cosine scoring function is a special case of g b r with normalized y e1 , y e2 and with Br " I.
section: PARAMETER LEARNING
The neural network parameters of all the models discussed above can be learned by minimizing a margin-based ranking objective , which encourages the scores of positive relationships (triplets) to be higher than the scores of any negative relationships (triplets). Usually only positive triplets are observed in the data. Given a set of positive triplets T , we can construct a set of "negative" triplets T 1 by corrupting either one of the relation arguments,
Denote the scoring function for triplet pe 1 , r, e 2 q as S pe1,r,e2q . The training objective is to minimize the margin-based ranking loss
section: INFERENCE TASK I: LINK PREDICTION
We first conduct a comparison study of different embedding models on the canonical link prediction task, which is to predict the correctness of unseen triplets. As in (Bordes et al., 2013b), we formulate link prediction as an entity ranking task. For each triplet in the test data, we treat each entity as the target entity to be predicted in turn. Scores are computed for the correct entity and all the corrupted entities in the dictionary and are ranked in descending order. We consider Mean Reciprocal Rank (MRR) (an average of the reciprocal rank of an answered entity overall test triplets), HITS@10 (top-10 accuracy), and Mean Average Precision (MAP) (as used in () as the evaluation metrics.
We examine five embedding models in decreasing order of complexity: (1) NTN with 4 tensor slices as in; (2) Bilinear+Linear, NTN with 1 tensor slice and without the non-linear layer; (3) TransE, a special case of Bilinear+Linear (see Implementation details All the models were implemented in C# and using GPU. Training was implemented using mini-batch stochastic gradient descent with AdaGrad (). At each gradient step, we sampled for each positive triplet two negative triplets, one with a corrupted subject entity and one with a corrupted object entity. The entity vectors are renormalized to have unit length after each gradient step (it is an effective technique that empirically improved all the models).
For the relation parameters, we used standard L2 regularization. For all models, we set the number of mini-batches to 10, the dimensionality of the entity vector d " 100, the regularization parameter 0.0001, and the number of training epochs T " 100 on FB15k and FB15k-401 and T " 300 on WN (T was determined based on the learning curves where the performance of all models plateaued.)
The learning rate was initially set to 0.1 and then adapted during training by AdaGrad.
section: RESULTS
section: FB15k
FB15k. We attribute such discrepancy mainly to the different choice of SGD optimization: AdaGrad vs. constant learning rate. We also found that Bilinear consistently provides comparable or better performance than TransE, especially on WN. Note that WN contains much more entities than FB, it may require the parametrization of relations to be more expressive to better handle the richness of entities. Interestingly, we found that a simple variant of Bilinear -BILINEAR-DIAG, clearly outperforms all baselines on FB and achieves comparable performance to Bilinear on WN. Note that BILINEAR-DIAG has the limitation of encoding the difference between a relation and its inverse. Still, as there is a large variety of relations in FB and the average number of training examples seen by each relation is relatively small (compared to WN), the simple form of BILINEAR-DIAG is able to provide good prediction performance.
Multiplicative vs. Additive Interactions Note that BILINEAR-DIAG and TRANSE have the same number of model parameters and their difference can be viewed as the operational choices of the composition of two entity vectors -BILINEAR-DIAG uses weighted element-wise dot product (multiplicative operation) and TRANSE uses element-wise subtraction with a bias (additive operation). To highlight the difference, here we use DISTMULT and DISTADD to refer to BILINEAR-DIAG and TRANSE, respectively. Comparisons between these two models can provide us more insights on the effect of two common choices of compositional operations -multiplication and addition for modeling entity relations. Overall, we observed superior performance of DISTMULT on all the datasets in. shows the HITS@10 score on four types of relation categories (as defined in (Bordes et al., 2013b)) on FB15k-401 when predicting the subject entity and the object entity respectively. We can see that DISTMULT significantly outperforms DISTADD in almost all the categories.
Predicting subject entities Predicting object entities 1-to-1 1-to-n n-to-1 n-to-n 1-to-1 1-to-n n-to-1 n-to-n DISTADD 70.0 76.: Results by relation categories: one-to-one, one-to-many, many-to-one and many-to-many
Initialization of Entity Vectors In the following, we examine the learning of entity representations and introduce two further improvements: using non-linear projection and initializing entity vectors with pre-trained vectors. We focus on DISTMULT as our baseline and compare it with the two modifications DISTMULT-tanh (using f " tanh for entity projection ) and DISTMULT-tanh-EV-init (initializing the entity parameters with the 1000-dimensional pre-trained entity vectors released by) on FB15k-401. We also reimplemented the initialization technique introduced in) -each entity is represented as an average of its word vectors and the word vectors are initialized using the 300-dimensional pre-trained word vectors released by word2vec. We denote this method as DISTMULT-tanh-WV-init. Inspired by), we design anew evaluation setting where the predicted entities are automatically filtered according to "entity types" (entities that appear as the subjects/objects of a relation have the same type defined by that relation). This provides us with better understanding of the model performance when some entity type information is provided.: Evaluation with pre-trained vectors
In, we can see that DISTMULT-tanh-EV-init provides the best performance on all the metrics. Surprisingly, we observed performance drops by DISTMULT-tanh-WV-init. We suspect that this is because word vectors are not appropriate for modeling entities described by non-compositional phrases (more than 73% of the entities in FB15k-401 are person names, locations, organizations and films). The promising performance of DISTMULT-tanh-EV-init suggests that the embedding model can greatly benefit from pre-trained entity-level vectors using external textual resources.
section: INFERENCE TASK II: RULE EXTRACTION
In this section, we focus on a complementary inference task, where we utilize the learned embeddings to extract logical rules from the KB. For example, given the fact that a person was born in New York and New York is a city of the United States, then the person's nationality is the United States:
BornInCitypa, bq ^ CityOf Countrypb, cq ùñ N ationalitypa, cq
Such logical rules can serve four important purposes. First, they can help deduce new facts and complete the existing KBs. Second, they can help optimize data storage by storing only rules instead of large amounts of extensional data, and generate facts only at inference time. Third, they can support complex reasoning. Lastly, they can provide explanations for inference results, e.g. we may infer that people's professions usually involve the specialization of the field they study, etc.
The key problem of extracting Horn rules like the aforementioned example is how to effectively explore the search space. Traditional rule mining approaches directly operate on the KB graphthey search for possible rules (i.e. closed-paths in the graph) by pruning rules with low statistical significance and relevance (). These approaches often fail on large KB graphs due to scalability issues. In the following, we introduce a novel embedding-based rule mining approach whose efficiency is not affected by the size of the KB graph but rather by the number of distinct types of relations in the KB (which is usually relatively small). It can also mine better rules due to its strong generalizability.
section: BACKGROUND AND NOTATIONS
For a better illustration, we adopt the graph view of KB. Each binary relation rpa, bq is a directed edge from node a to node band with link type r. We are interested in extracting Horn rules that consist of ahead relation H and a sequence of body relations B 1 , ..., B n : B 1 pa 1 , a 2 q ^ B 2 pa 2 , a 3 q ^ ... ^ B n pan , a n`1 q ùñ Hpa 1 , a n`1 q
where a i are variables that can be substituted by entities. We constrain the body relations B 1 , ..., B n to form a directed path in the graph and the head relation H to from a directed edge that close the path (from the start of the path to the end of the path). We denote such property as the closed-path property. For consecutive relations that share one variable but do not form a path, e,g, B i´1 pa, bq ^ Bi pa, cq, we can replace one of the relations with its inverse relation, so that the relations are connected by an object and an subject, e.g. B ´1 i´1 pb, aq ^ Bi pa, cq. We are interested in mining rules that reflect relationships among different relation types, therefore we also constrain B 1 , ..., B n , H to have distinct relation types. A rule is instantiated when all variables are substituted by entities. We denote the length of the rule as the number of body relations. In general longer rules are harder to extract due to the exponential search space. In our experiments, we focus on extracting rules of length 2 and 3.
In KBs, entities usually have types and relations often can only take arguments of certain types. For example, BornInCity relation can only take a person as the subject and a location as the object. For each relation r, we denote the domain of its subject argument (the set of entities that can appear in the subject position) as X rand similarly the domain of its object argument as Y r . Such domain information can be extremely useful in restricting the search space of logical rules.
section: EMBEDDING-BASED RULE EXTRACTION
For simplicity, we consider Horn rules of length 2 (longer rules can be easily derived from this case):
Note that the body of the rule can be viewed as the composition of relations B 1 and B 2 , which is anew relation that has the property that entities a and care in a relation if and only if there is an entity b which simultaneously satisfies two relations B 1 pa, bq and B 2 pb, cq.
We model relation composition as multiplication or addition of two relation embeddings. Here we focus on relation embeddings that are in the form of vectors (as in TRANSE) and matrices (as in BILINEAR and its variants). The composition results in anew embedding that lies in the same relation space. Specifically, we use addition for relation vector embeddings and multiplication for relation matrix embeddings. This is inspired by two different properties: (1) if a relation corresponds to a translation vector V and assume ya `V´y b « 0 when Bpa, bq holds, then we have the property that ya ` V 1 « y band y b ` V 2 « y c implies ya ` pV 1 ` V 2 q « y c ; (2) if a relation corresponds to a matrix Min the bilinear transformation and assume y Ta My b « 1 when Bpa, bq holds, also ya and y bare unit vectors and y Ta M is still a unit vector 3 , then we have the property that y Ta M 1 « y Tb and y Tb M 2 « y Tc implies y Ta pM 1 M 2 q « y Tc . To simulate the implication in 5, we want the composition result of relation B 1 and B 2 to demonstrate similar behavior to the embedding of relation H. We assume the similarity between relation embeddings is related to the Euclidean distance if the embeddings are vectors and to the Frobenius norm if the embeddings are matrices. This distance metric allows us to rank possible pairs of relations with respect to the relevance of their composition to the target relation.
Note that we do not need to enumerate all possible pairs of relations in the KB. For example, if the relation in the head is r, then we are only interested in relation pairs pp, qq that satisfy the type constraints, namely:
As mentioned before, the arguments (entities) of relations are usually strongly typed in KBs. Applying such domain constraints can effectively reduce the search space.
In Algorithm 1, we describe our rule extraction algorithm for general closed-path Horn rules as in Eq. (4). In Step 7, ˝ denotes vector addition or matrix multiplication. We apply a global threshold value δ in our experiments to filter candidate sequences for each relation r, and then automatically select the top remaining sequences by applying a heuristic thresholding strategy based on the difference of the distance scores: sort the sequences by increasing distance d 1 , ..., d T and set the cut-off point to be the j-th sequence where j " arg maxi pd i`1 ´ d i q.
section: EXPERIMENTS
We evaluate our rule extraction method (denoted as EMBEDRULE) on the FB15k-401 dataset. In our experiments, we remove the equivalence relations and relations whose domains have cardinality Algorithm 1 EMBEDRULE 1: Input: KB " tpe 1 , r, e 2 qu, relation set R 2: Output: Candidate rules Q 3: for each r in R do 4:
Select the set of start relations S " ts : X s X X r ‰ Hu
section: 5:
Select the set of end relations T " tt : Y t X Y r ‰ Hu
section: 6:
Find all possible relation sequences 7:
Select the K-NN sequences P 1 Ď P for r based on distpM r , M p1 ˝ ¨ ¨ ¨ ˝ M pn q 8:
Form candidate rules using P 1 where r is the head relation and p PP 1 is the body in a rule 9:
Add the candidate rules into Q 10: end for 1 since rules involving these relations are not interesting. This results in training data that contains 485,741 facts, 14,417 entities, and 373 relations. Our EMBEDRULE algorithm identifies 60,020 possible length-2 relation sequences and 2,156,391 possible length-3 relation sequences. We then apply the thresholding method described in Section 5.2 to further select top "3.9K length-2 rules and "2K length-3 rules . By default all the extracted rules are ranked by decreasing confidence, which is computed as the ratio of the correct predictions to the total number of predictions, where predictions are triplets that are derived from the instantiated rules where the body relations are observed.
We implemented four versions of EMBEDRULE using embeddings trained from TRANSE (DIS-TADD), BILINEAR, BILINEAR-DIAG (DISTMULT) and DISTMULT-tanh-EV-init with corresponding composition functions. We also compare our approaches to AMIE (), a state-of-the-art rule mining system that can efficiently search for Horn rules in large-scale KBs by using novel measurements of support and confidence. The system extracts close rules -a superset of the rules we consider in this paper: every relation in the body is connected to the following relation by sharing an entity variable, and every entity variable in the rule appears at least twice. We run AMIE with the default setting on the same training set. It extracts 2,201 possible length-1 rules and 46,975 possible length-2 rules, among which 3,952 rules have the close-path property. We compare these length-2 rules with the similar number of length-2 rules extracted by EMBEDRULE. By default AMIE ranks rules by PCA confidence (a normalized confidence that takes into account the incompleteness of KBs). However we found that ranking by the standard confidence gives better performance than the PCA confidence on the Freebase dataset we use.
For computational cost, EmbedRule mines length-2 rules in 2 minutes and mines length-3 rules in 20 minutes (the computational time is similar when using different types of embeddings). AMIE mines rules of length ď 2 in 9 minutes. All methods are evaluated on a machine with a 64-bit processor, 2 CPUs and 8GB memory.
We consider precision as the evaluation metric, which is the ratio of predictions that are in the test (unseen) data to all the generated unseen predictions. Note that this is an estimation, since a prediction is not necessarily "incorrect" if it is not seen. suggested to identify incorrect predictions based on the functional property of relations. However, we find that most relations in our datasets are not functional. For a better estimation, we manually labeled the top 30 unseen facts predicted by each method by checking Wikipedia. We also remove rules where the head relations are hard to justified due to dynamic factors (i.e. involving the word "current"). compares the predictions generated by the length-2 rules extracted by different methods. We plot the aggregated precision of the top rules that produce up to 10K predictions in total. From left to right, the n-th data point represents the total number of predictions of the top n rules and the estimated precision of these predictions. We can see that EMBEDRULE that uses embeddings trained from the bilinear objective (BILINEAR, DISTMULT and DISTMULT-TANH-EV-INIT) consistently outperforms AMIE. This suggests that the bilinear embeddings contain good amount of information about relations which allows for effective rule selection without looking at the entities. For example, AMIE fails to extract TV P rogramCountryof Originpa, bq ^ CountryOf f icialLanguagepb, cq ùñ TV P rogramLanguagepa, cq by relying on the instantiations of the rule occurred in the observed KB while all the bilinear variants of EMBEDRULE successfully extract the rule purely based on the embeddings of the three involved relations.
section: RESULTS
We can also see that in general, using multiplicative composition of matrix embeddings (from DIST-MULT and BILINEAR) results in better performance compared to using additive composition of vector embeddings (from DISTADD). We found many examples where DISTADD fails to retrieve rules because it assigns large distance between the composition of the body relations and the head relation in the embedding space while its multiplicative counterpart DISTMULT ranks the composition result much closer to the head relation. For example, DISTADD prunes the possible composition F ilmDistributorInRegion^RegionGDP Currency for relation F ilmBudgetCurrency while DISTMULT ranks the composition as the nearest neighbor of F ilmBudgetCurrency. We also look at the results for length-3 rules generated by different implementations of EMBEDRULE in. We can see that the initial length-3 rules extracted by EMBEDRULE can provide very good precision in general. We can also see that BILINEAR consistently outperforms DISTMULT and DISTADD on the top 1K predictions and DISTMULT-TANH-EV-INIT tends to outperform the other methods as more predictions are generated. We think that the fact that BILINEAR starts to show more advantage over DISTMULT in extracting longer rules confirm the limitation of representing relations by diagonal matrices, as longer rules requires the modeling of more complex relation semantics.
section: CONCLUSION
In this paper, we present a general framework for learning representations of entities and relations in KBs. Under the framework, we empirically evaluate different embedding models on knowledge inference tasks. We show that a simple formulation of bilinear model can outperform the state-ofthe-art embedding models for link prediction on Freebase. Furthermore, we examine the learned embeddings by utilizing them to extract logical rules from KBs. We show that embeddings learned from the bilinear objective can capture compositional semantics of relations and be successfully used to extract Horn rules that involve compositional reasoning. For future work, we aim to exploit deep structure in the neural network framework. As learning representations using deep networks has shown great success in various applications (, it may also help capturing hierarchical structure hidden in the multi-relational data. Further, tensor constructs have been usefully applied to some deep learning architectures (. Related constructs and architectures may help improve multi-relational learning and inference.
section: APPENDIX A EXAMPLES OF THE EXTRACTED HORN RULES
Examples of length-2 rules extracted by EMBEDRULE with embeddings learned from DISTMULTtanh-EV-init: Grefenstette, Edward. Towards a formal distributional semantics: Simulating logical calculi with tensors. In *SEM, 2013.
